<!DOCTYPE html><meta charset="utf-8"><p>#---
layout: ../../layouts/Post.astro
title: “HackTheBox: Example Machine”
description: “Walkthrough covering initial enumeration with Nmap, exploiting SQL injection for foothold, and leveraging a SUID binary for root.”
date: “2026-02-15”
type: writeup
platform: htb
tags: [“sqli”, “privesc”]
backLink: /writeups
backLabel: Back to writeups
#---</p>
<h2 id="overview">Overview</h2>
<p>Example Machine is a medium-difficulty Linux box on HackTheBox. It involves web enumeration, SQL injection for initial access, and exploiting a misconfigured SUID binary for privilege escalation.</p>
<h2 id="enumeration">Enumeration</h2>
<p>Starting with an Nmap scan to identify open ports and services:</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="plaintext"><code><span class="line"><span>nmap -sC -sV -oN nmap/initial 10.10.10.100</span></span>
<span class="line"><span></span></span>
<span class="line"><span>PORT   STATE SERVICE VERSION</span></span>
<span class="line"><span>22/tcp open  ssh     OpenSSH 8.9</span></span>
<span class="line"><span>80/tcp open  http    Apache 2.4.52</span></span></code></pre>
<p>Port 80 hosts a web application. Running <code>gobuster</code> reveals a login page at <code>/admin</code> and an API endpoint at <code>/api/users</code>.</p>
<h2 id="foothold">Foothold</h2>
<p>The login page is vulnerable to SQL injection. Testing with a basic payload in the username field:</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="plaintext"><code><span class="line"><span>' OR 1=1 -- -</span></span></code></pre>
<p>This bypasses authentication and grants access to the admin dashboard. From the dashboard, we can upload a PHP reverse shell via the file upload feature.</p>
<h2 id="privilege-escalation">Privilege Escalation</h2>
<p>After catching the shell, checking for SUID binaries:</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#B392F0">find</span><span style="color:#9ECBFF"> /</span><span style="color:#79B8FF"> -perm</span><span style="color:#79B8FF"> -4000</span><span style="color:#79B8FF"> -type</span><span style="color:#9ECBFF"> f</span><span style="color:#F97583"> 2></span><span style="color:#9ECBFF">/dev/null</span></span></code></pre>
<p>A custom binary <code>/opt/backup</code> runs as root and accepts a filename argument without sanitisation. We can use this to read the root flag or escalate to a root shell.</p>
<blockquote>
<p>Always check SUID binaries — custom ones are often the intended privesc vector on CTF machines.</p>
</blockquote>
<h2 id="lessons-learned">Lessons Learned</h2>
<p>This box reinforced the importance of thorough web enumeration and checking for common injection points. The privilege escalation was a good reminder to always audit SUID binaries on any system you’re testing.</p>